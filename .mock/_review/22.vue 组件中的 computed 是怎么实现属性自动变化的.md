# vue computed

怎么用的？

1.组件中的计算属性
2.store 中的计算属性

computed 属性依赖的原始数据变化时，会自动重新计算

## 原理

### 响应式依赖追踪

Vue 使用了一个响应式系统，它能够追踪数据的变化。每个组件实例都有一个 watcher 实例，它会在组件渲染过程中把接触过的数据属性记录为依赖。当依赖的值发生变化时，setter 出发 dep 调用，遍历 watcher ，会通知视图更新。

对于 computed 属性，Vue 会为每个属性创建一个自己的 watcher。
当你在 computed 属性中引用了响应式数据时，Vue 会将这个数据作为一个依赖加入到这个 watcher 中。
之后，如果这些依赖的数据发生了变化，watcher 会触发计算属性的重新求值

### 缓存机制

计算属性默认只有在其响应式依赖发生改变时才会重新求值；

### 工作流程

- 1.初始化: 当组件初始化时，Vue 会遍历组件的 computed 属性，为每个属性创建一个 watcher。

- 2.依赖收集: 当计算属性被首次访问时，Vue 会执行属性的 getter 函数，getter 函数会访问响应式数据，这时 Vue 会将这些数据作为依赖加入到计算属性的 watcher 中。

- 3.变更检测: 如果计算属性的任何一个依赖发生了变化，Vue 会通知计算属性的 watcher。

- 4.重新计算: watcher 会重新运行属性的 getter 函数来计算新的值，并且更新视图中的相应部分。

- 5.缓存: 如果依赖没有变化，getter 函数不会重新执行，而是直接返回上一次计算的结果。
